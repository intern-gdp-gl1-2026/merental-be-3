post:
  summary: Create a new reservation
  description: |
    Creates a new car reservation for a user.
    
    **Total Price Calculation:**
    - If `total_price` is not provided, it will be automatically calculated based on the car's daily rate
    - Formula: `total_price = car.price_per_day Ã— ((end_date - start_date) / 86400)`
    - The result is the total rental cost for the entire reservation duration
    
    **Authentication & Authorization:**
    - Requires valid JWT token (Bearer authentication)
    - Reservation will be created for the authenticated user
  operationId: createReservation
  tags:
    - Reservations
  security:
    - bearerAuth: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - car
            - start_date
            - end_date
          properties:
            car:
              type: integer
              description: Car ID that the user wants to reserve
              minimum: 1
              example: 1
            start_date:
              type: integer
              format: int64
              description: |
                Reservation start date as Unix epoch timestamp (seconds).
                Must be less than end_date.
              minimum: 0
              example: 1737792000
            end_date:
              type: integer
              format: int64
              description: |
                Reservation end date as Unix epoch timestamp (seconds).
                Must be greater than start_date.
                The system will check for conflicts with other confirmed/pending reservations for this car.
              minimum: 0
              example: 1738224000
  responses:
    "201":
      description: Created
      content:
        application/json:
          schema:
            type: object
            required:
              - message
              - reservation
            properties:
              message:
                type: string
                example: Reservation created successfully
              reservation:
                $ref: '../openapi.yml#/components/schemas/Reservation'
    "400":
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '../openapi.yml#/components/schemas/BadRequestErrorResponse'
    "401":
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '../openapi.yml#/components/schemas/UnauthorizedErrorResponse'
    "404":
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '../openapi.yml#/components/schemas/NotFoundErrorResponse'
    "409":
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '../openapi.yml#/components/schemas/ConflictErrorResponse'

get:
  summary: Get all reservations
  description: |
    Returns a list of reservations with optional status filtering.
    
    **Authorization & Access Control:**
    - Requires valid JWT token (Bearer authentication)
    - Regular users will only see their own reservations
    - Admin users can see all reservations
  operationId: getReservations
  tags:
    - Reservations
  security:
    - bearerAuth: []
  parameters:
    - name: status
      in: query
      description: Filter by reservation status (pending, confirmed, cancelled, completed)
      required: false
      schema:
        type: string
        enum:
          - pending
          - confirmed
          - cancelled
          - completed
      example: confirmed
  responses:
    '200':
      description: List of reservations
      content:
        application/json:
          schema:
            type: object
            properties:
              reservations:
                type: array
                items:
                  $ref: '../openapi.yml#/components/schemas/Reservation'
    '401':
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '../openapi.yml#/components/schemas/UnauthorizedErrorResponse'
